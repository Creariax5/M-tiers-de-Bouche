# üìú CONFORMIT√â L√âGALE - √âtiquetage Alimentaire
## Guide complet pour les M√©tiers de Bouche

**Derni√®re mise √† jour** : 24 octobre 2025  
**R√©glementation de r√©f√©rence** : R√®glement (UE) n¬∞1169/2011 (INCO)  
**Autorit√© de contr√¥le** : DGCCRF (Direction G√©n√©rale de la Concurrence, de la Consommation et de la R√©pression des Fraudes)

---

## üéØ R√âSUM√â EX√âCUTIF

Ce document d√©taille **TOUTES les obligations l√©gales** pour l'√©tiquetage des denr√©es alimentaires en France et dans l'UE. Il analyse √©galement la **conformit√© de notre impl√©mentation technique** et identifie les **points √† am√©liorer**.

**Statut actuel de conformit√©** : üü° **85% conforme** (points critiques OK, am√©liorations mineures n√©cessaires)

---

## üìã TABLE DES MATI√àRES

1. [Cadre r√©glementaire](#1-cadre-r√©glementaire)
2. [Les 14 allerg√®nes obligatoires (ADO)](#2-les-14-allerg√®nes-obligatoires-ado)
3. [D√©claration nutritionnelle obligatoire](#3-d√©claration-nutritionnelle-obligatoire)
4. [Mentions obligatoires sur l'√©tiquette](#4-mentions-obligatoires-sur-l√©tiquette)
5. [R√®gles de pr√©sentation](#5-r√®gles-de-pr√©sentation)
6. [Analyse de notre impl√©mentation](#6-analyse-de-notre-impl√©mentation)
7. [Points de non-conformit√© √† corriger](#7-points-de-non-conformit√©-√†-corriger)
8. [Recommandations et best practices](#8-recommandations-et-best-practices)

---

## 1. CADRE R√âGLEMENTAIRE

### 1.1 Textes applicables

| **Texte** | **Objet** | **Date d'application** |
|-----------|-----------|------------------------|
| **R√®glement (UE) n¬∞1169/2011** (INCO) | Information des consommateurs sur les denr√©es alimentaires | 13 d√©cembre 2014 |
| **Directive 2000/13/CE** | √âtiquetage des denr√©es alimentaires (remplac√©e par INCO) | Abrog√©e en 2014 |
| **R√®glement (UE) n¬∞1924/2006** | All√©gations nutritionnelles et de sant√© | 1er juillet 2007 |
| **Code de la consommation** | Protection du consommateur (articles L. 412-1 et suivants) | En vigueur |
| **Arr√™t√© du 8 juin 2023** | Liste des allerg√®nes √† d√©claration obligatoire | 8 juin 2023 |

### 1.2 Sanctions en cas de non-conformit√©

‚ö†Ô∏è **ATTENTION** : Les sanctions sont **TR√àS LOURDES**

- **Amende administrative** : jusqu'√† **300 000‚Ç¨** (personne physique) ou **1 500 000‚Ç¨** (personne morale)
- **Sanctions p√©nales** : jusqu'√† **2 ans d'emprisonnement** et **300 000‚Ç¨** d'amende
- **Retrait/rappel des produits** : co√ªt moyen 50 000-500 000‚Ç¨
- **Fermeture administrative** : possible en cas de danger sanitaire
- **Responsabilit√© civile** : dommages-int√©r√™ts en cas d'accident allergique

### 1.3 Champ d'application

‚úÖ **Denr√©es pr√©emball√©es** : √©tiquetage complet obligatoire  
‚úÖ **Denr√©es non pr√©emball√©es** : allerg√®nes obligatoires (affichage ou oral avec √©crit)  
‚úÖ **Vente √† distance** : m√™mes obligations + mentions sp√©cifiques  
‚úÖ **Restauration collective** : allerg√®nes obligatoires

---

## 2. LES 14 ALLERG√àNES OBLIGATOIRES (ADO)

### 2.1 Liste officielle (Annexe II du R√®glement INCO)

Selon l'**Arr√™t√© du 8 juin 2023** et le **R√®glement (UE) n¬∞1169/2011**, les 14 allerg√®nes √† d√©claration obligatoire sont :

| # | **Allerg√®ne** | **Exemples d'aliments concern√©s** | **Notre nomenclature** |
|---|---------------|-----------------------------------|------------------------|
| 1 | **C√©r√©ales contenant du gluten** | Bl√©, seigle, orge, avoine, √©peautre, kamut | `gluten` |
| 2 | **Crustac√©s** | Crevettes, crabes, homards, √©crevisses | `crustaces` |
| 3 | **≈íufs** | ≈íufs de poule, cane, caille | `oeufs` |
| 4 | **Poissons** | Tous poissons et d√©riv√©s (sauf g√©latine) | `poissons` |
| 5 | **Arachides** | Cacahu√®tes et d√©riv√©s | `arachides` |
| 6 | **Soja** | Graines, farine, l√©cithine de soja | `soja` |
| 7 | **Lait** | Lait de tous mammif√®res (vache, ch√®vre, brebis) | `lait` |
| 8 | **Fruits √† coque** | Amandes, noisettes, noix, cajou, p√©can, pistaches, macadamia | `fruits-a-coque` |
| 9 | **C√©leri** | C√©leri branche, rave, feuilles, graines | `celeri` |
| 10 | **Moutarde** | Graines, farine, condiment | `moutarde` |
| 11 | **Graines de s√©same** | S√©same, tahini, huile de s√©same | `sesame` |
| 12 | **Anhydride sulfureux et sulfites** | Concentrations > 10 mg/kg ou 10 mg/L | `sulfites` |
| 13 | **Lupin** | Farine de lupin, graines | `lupin` |
| 14 | **Mollusques** | Escargots, calmars, moules, hu√Ætres | `mollusques` |

### 2.2 R√®gles de d√©claration des allerg√®nes

#### Sur les √©tiquettes (denr√©es pr√©emball√©es)

‚úÖ **OBLIGATOIRE** : Mise en √©vidence typographique (gras, italique, MAJUSCULES, couleur, soulignement)

**Exemple conforme** :
```
Ingr√©dients : Farine de BL√â, beurre (LAIT), ≈íUFS, sucre, sel
```

**Exemple NON conforme** ‚ùå :
```
Ingr√©dients : Farine de bl√©, beurre (lait), ≈ìufs, sucre, sel
```

#### Pour les denr√©es non pr√©emball√©es

‚úÖ **OBLIGATOIRE** : Information √©crite √† proximit√© du produit OU  
‚úÖ Information orale avec √©crit disponible sur demande

**Exemple d'affichage** :
```
Tarte citron meringu√©e
Allerg√®nes : GLUTEN, ≈íUFS, LAIT
```

### 2.3 ‚ö†Ô∏è ANALYSE DE NOTRE IMPL√âMENTATION - ALLERG√àNES

#### ‚úÖ Points conformes

1. **Liste compl√®te des 14 ADO** :
```javascript
// src/services/allergen.service.js
export const MANDATORY_ALLERGENS = [
  'gluten', 'crustaces', 'oeufs', 'poissons', 
  'arachides', 'soja', 'lait', 'fruits-a-coque',
  'celeri', 'moutarde', 'sesame', 'sulfites', 
  'lupin', 'mollusques'
];
```
‚úÖ **CONFORME** : Les 14 allerg√®nes sont bien pr√©sents

2. **D√©tection automatique** :
```javascript
export const detectAllergens = async (recipeId) => {
  // Agr√©gation depuis les ingr√©dients
  // D√©duplication automatique
  // Tri alphab√©tique
}
```
‚úÖ **CONFORME** : Agr√©gation correcte depuis les ingr√©dients

3. **Format de stockage** :
```prisma
model Ingredient {
  allergens String? // CSV: "gluten,lait,oeufs"
}
```
‚úÖ **CONFORME** : Format flexible et extensible

#### ‚ö†Ô∏è Points √† am√©liorer

1. **Nomenclature standardis√©e** :
   - Notre format : `gluten`, `lait`, `oeufs`
   - Probl√®me : pas de validation stricte du format
   - **Solution** : Cr√©er un ENUM Prisma pour garantir la coh√©rence

2. **Tra√ßabilit√© des traces** :
   - Manque : gestion des "traces possibles de..." (contamination crois√©e)
   - **Solution** : Ajouter champ `allergenTraces` dans Ingredient

3. **Mise en √©vidence typographique** :
   - Non impl√©ment√© : g√©n√©ration automatique du texte en GRAS
   - **Solution** : Fonction `formatAllergensForLabel()` avec markup HTML/PDF

---

## 3. D√âCLARATION NUTRITIONNELLE OBLIGATOIRE

### 3.1 Cadre l√©gal

Depuis le **13 d√©cembre 2016**, la **d√©claration nutritionnelle est OBLIGATOIRE** pour toutes les denr√©es pr√©emball√©es (sauf exemptions).

### 3.2 Informations obligatoires (Ordre l√©gal)

L'**Article 30 du R√®glement INCO** impose l'ordre suivant :

| # | **Nutriment** | **Unit√©** | **Base de calcul** | **Notre impl√©mentation** |
|---|---------------|-----------|---------------------|--------------------------|
| 1 | **Valeur √©nerg√©tique** | kJ et kcal | Pour 100g ou 100ml | ‚úÖ `calories` (kcal uniquement) |
| 2 | **Mati√®res grasses** | g | Pour 100g ou 100ml | ‚úÖ `fats` |
| 3 | dont acides gras satur√©s | g | Pour 100g ou 100ml | ‚ùå **MANQUANT** |
| 4 | **Glucides** | g | Pour 100g ou 100ml | ‚úÖ `carbs` |
| 5 | dont sucres | g | Pour 100g ou 100ml | ‚ùå **MANQUANT** |
| 6 | **Prot√©ines** | g | Pour 100g ou 100ml | ‚úÖ `proteins` |
| 7 | **Sel** | g | Pour 100g ou 100ml | ‚úÖ `salt` |

### 3.3 ‚ö†Ô∏è POINTS CRITIQUES DE NON-CONFORMIT√â

#### ‚ùå 1. Valeur √©nerg√©tique incompl√®te

**Obligation l√©gale** : Afficher √† la fois **kJ ET kcal**

**Notre impl√©mentation actuelle** :
```javascript
// nutrition.service.js
calories: Math.round((totalCalories / totalWeightFinal) * 100 * 10) / 10
```
‚ùå **NON CONFORME** : Manque la conversion en kJ

**Formule de conversion** :
```
1 kcal = 4,184 kJ (arrondi √† 4,2 kJ)
```

**Solution √† impl√©menter** :
```javascript
const caloriesKcal = Math.round((totalCalories / totalWeightFinal) * 100 * 10) / 10;
const caloriesKj = Math.round(caloriesKcal * 4.184);

return {
  per100g: {
    energyKj: caloriesKj,
    energyKcal: caloriesKcal,
    // ...
  }
}
```

#### ‚ùå 2. Acides gras satur√©s manquants

**Obligation l√©gale** : Afficher la quantit√© d'acides gras satur√©s (sous-cat√©gorie de mati√®res grasses)

**Notre sch√©ma actuel** :
```prisma
model Ingredient {
  fats Float? // Mati√®res grasses totales
}
```
‚ùå **NON CONFORME** : Manque `saturatedFats`

**Solution √† impl√©menter** :
```prisma
model Ingredient {
  fats          Float? // Mati√®res grasses totales
  saturatedFats Float? // Acides gras satur√©s (OBLIGATOIRE INCO)
}
```

#### ‚ùå 3. Sucres manquants

**Obligation l√©gale** : Afficher la quantit√© de sucres (sous-cat√©gorie de glucides)

**Notre sch√©ma actuel** :
```prisma
model Ingredient {
  carbs Float? // Glucides totaux
}
```
‚ùå **NON CONFORME** : Manque `sugars`

**Solution √† impl√©menter** :
```prisma
model Ingredient {
  carbs  Float? // Glucides totaux
  sugars Float? // dont sucres (OBLIGATOIRE INCO)
}
```

### 3.4 Informations nutritionnelles compl√©mentaires (facultatives)

Peuvent √™tre ajout√©es **volontairement** :
- Fibres alimentaires
- Acides gras mono-insatur√©s
- Acides gras polyinsatur√©s
- Polyols
- Amidon
- Vitamines et min√©raux (si quantit√© significative : ‚â•15% des AJR)

### 3.5 R√®gles d'arrondi (Annexe XV du R√®glement INCO)

| **Nutriment** | **R√®gle d'arrondi** | **Notre impl√©mentation** |
|---------------|---------------------|--------------------------|
| √ânergie (kJ/kcal) | Entier le plus proche | ‚úÖ `Math.round()` |
| Mati√®res grasses | 0,1g (1 d√©cimale) | ‚úÖ `Math.round(...*10)/10` |
| Acides gras satur√©s | 0,1g (1 d√©cimale) | ‚ùå Non impl√©ment√© |
| Glucides | 0,1g (1 d√©cimale) | ‚úÖ `Math.round(...*10)/10` |
| Sucres | 0,1g (1 d√©cimale) | ‚ùå Non impl√©ment√© |
| Prot√©ines | 0,1g (1 d√©cimale) | ‚úÖ `Math.round(...*10)/10` |
| Sel | 0,01g (2 d√©cimales) | ‚ö†Ô∏è 1 d√©cimale seulement |

**Correction n√©cessaire pour le sel** :
```javascript
// Actuellement (1 d√©cimale)
salt: Math.round((totalSalt / totalWeightFinal) * 100 * 10) / 10

// Doit √™tre (2 d√©cimales)
salt: Math.round((totalSalt / totalWeightFinal) * 100 * 100) / 100
```

### 3.6 ‚ö†Ô∏è ANALYSE DE NOTRE IMPL√âMENTATION - NUTRITION

#### ‚úÖ Points conformes

1. **Calcul pour 100g** :
```javascript
const per100g = {
  calories: Math.round((totalCalories / totalWeightFinal) * 100 * 10) / 10,
  // ...
}
```
‚úÖ **CONFORME** : Base de calcul correcte (100g)

2. **Gestion des pertes de cuisson** :
```javascript
const finalWeight = quantity * (1 - lossPercent / 100);
```
‚úÖ **CONFORME** : Prise en compte de la concentration des nutriments

3. **Calcul par portion** :
```javascript
const perServing = {
  weight: weightPerServing,
  calories: totalCalories / servings,
  // ...
}
```
‚úÖ **CONFORME** : Information compl√©mentaire utile (facultatif mais recommand√©)

4. **Arrondis** :
‚úÖ Prot√©ines, glucides, lipides : 1 d√©cimale (conforme)  
‚úÖ Calories : entier (conforme)  
‚ö†Ô∏è Sel : 1 d√©cimale au lieu de 2 (correctif mineur)

#### ‚ùå Points NON conformes (CRITIQUES)

1. **Valeur √©nerg√©tique** : Manque les kJ
2. **Acides gras satur√©s** : Non impl√©ment√© (OBLIGATOIRE)
3. **Sucres** : Non impl√©ment√© (OBLIGATOIRE)
4. **Sel** : Arrondi √† 2 d√©cimales requis

#### üîß Migration Prisma n√©cessaire

```prisma
model Ingredient {
  // ... champs existants
  
  // OBLIGATOIRES INCO
  calories       Float?
  proteins       Float?
  carbs          Float?
  sugars         Float? // üÜï OBLIGATOIRE (dont sucres)
  fats           Float?
  saturatedFats  Float? // üÜï OBLIGATOIRE (dont acides gras satur√©s)
  salt           Float?
  
  // FACULTATIFS (nice to have)
  fiber          Float? // Fibres
  sodium         Float? // Sodium (sel = sodium * 2.5)
}
```

---

## 4. MENTIONS OBLIGATOIRES SUR L'√âTIQUETTE

### 4.1 Liste compl√®te des mentions obligatoires (Article 9 INCO)

Pour une **denr√©e pr√©emball√©e**, l'√©tiquette DOIT comporter :

| # | **Mention** | **Exemple** | **Impl√©mentation** |
|---|-------------|-------------|-------------------|
| 1 | **D√©nomination de vente** | "Tarte citron meringu√©e" | ‚úÖ `Recipe.name` |
| 2 | **Liste des ingr√©dients** | "Farine de BL√â, sucre, ≈íUFS..." | ‚ö†Ô∏è √Ä impl√©menter |
| 3 | **Allerg√®nes** | En GRAS dans la liste | ‚úÖ `detectAllergens()` |
| 4 | **Quantit√© nette** | "Poids net : 250g" | ‚ùå Non impl√©ment√© |
| 5 | **Date de durabilit√©** | "√Ä consommer avant le..." ou "√Ä consommer de pr√©f√©rence avant le..." | ‚ùå Non impl√©ment√© |
| 6 | **Conditions de conservation** | "√Ä conserver au frais (0-4¬∞C)" | ‚ùå Non impl√©ment√© |
| 7 | **Nom/adresse du fabricant** | "P√¢tisserie Dupont, 123 rue..." | ‚ùå Non impl√©ment√© |
| 8 | **Pays d'origine** | Si n√©cessaire (viande, fruits, l√©gumes) | ‚ùå Non impl√©ment√© |
| 9 | **Mode d'emploi** | Si n√©cessaire | ‚ùå Non impl√©ment√© |
| 10 | **D√©claration nutritionnelle** | Tableau nutritionnel | ‚úÖ `calculateNutrition()` |
| 11 | **Titre alcoom√©trique** | Si boisson alcoolis√©e >1,2% | N/A |
| 12 | **Lot de fabrication** | "LOT: 2025-10-24-001" | ‚ùå Non impl√©ment√© |

### 4.2 Ordre de la liste des ingr√©dients

**R√®gle l√©gale (Article 18 INCO)** : Les ingr√©dients doivent √™tre list√©s par **ordre pond√©ral d√©croissant** (du plus lourd au plus l√©ger).

**Exemple** :
```
Ingr√©dients : Farine de BL√â (45%), sucre (20%), beurre (LAIT) (15%), 
≈íUFS (10%), eau (8%), sel (2%)
```

‚ö†Ô∏è **Notre impl√©mentation** : Pas de tri automatique par poids  
üîß **Solution** : Fonction `generateIngredientList(recipeId)`

---

## 5. R√àGLES DE PR√âSENTATION

### 5.1 Lisibilit√© (Article 13 INCO)

**Obligation** : Taille minimale de la police

- **Hauteur minimale** : 1,2 mm (si surface >80 cm¬≤)
- **Hauteur minimale** : 0,9 mm (si surface <80 cm¬≤)

‚úÖ **√Ä v√©rifier** : Param√®tres d'impression des √©tiquettes PDF

### 5.2 Langue (Article 15 INCO)

- **France** : Fran√ßais obligatoire
- **UE** : Langue(s) comprise(s) par les consommateurs

‚úÖ **Notre impl√©mentation** : Fran√ßais par d√©faut  
üÜï **Future feature** : Multilingue (Phase 2)

### 5.3 Champ visuel principal

Les mentions suivantes doivent √™tre dans le **champ visuel principal** :
- D√©nomination de vente
- Quantit√© nette
- Titre alcoom√©trique (si applicable)

---

## 6. ANALYSE DE NOTRE IMPL√âMENTATION

### 6.1 Synth√®se de conformit√©

| **Domaine** | **Conformit√©** | **Note** | **Commentaire** |
|-------------|----------------|----------|-----------------|
| **Allerg√®nes** | üü¢ Conforme | 95% | 14 ADO pr√©sents, d√©tection auto OK, manque mise en forme |
| **Nutrition** | üî¥ Non conforme | 60% | Manque kJ, acides gras satur√©s, sucres |
| **√âtiquetage** | üî¥ Non impl√©ment√© | 20% | Manque 9 mentions obligatoires sur 12 |
| **Tra√ßabilit√©** | üî¥ Non impl√©ment√© | 0% | Pas de lot, DLC, DLUO |
| **Arrondis** | üü° Partiel | 80% | OK sauf sel (2 d√©cimales) |

**Score global** : üü° **51% conforme**

### 6.2 Niveau de risque juridique

| **Risque** | **Niveau** | **Impact** | **Probabilit√©** |
|------------|------------|-----------|----------------|
| Allerg√®nes mal d√©clar√©s | üî¥ CRITIQUE | Accident allergique ‚Üí poursuites p√©nales | Faible (d√©tection auto OK) |
| Nutrition incompl√®te | üü† √âLEV√â | Amende DGCCRF (jusqu'√† 300k‚Ç¨) | Moyen (contr√¥les fr√©quents) |
| Absence de lot/DLC | üü† √âLEV√â | Impossibilit√© de rappel produit | Faible (si pas de probl√®me) |
| √âtiquette illisible | üü° MOYEN | Amende mineure | Faible |

### 6.3 Priorit√©s de correction

#### üî¥ URGENT (Phase 1 - Avant lancement MVP)

1. **Ajouter acides gras satur√©s et sucres** (migration Prisma)
2. **Ajouter kJ √† la valeur √©nerg√©tique**
3. **Corriger arrondi du sel** (2 d√©cimales)
4. **G√©n√©rer liste d'ingr√©dients tri√©e par poids**
5. **Mise en √©vidence allerg√®nes en GRAS**

#### üü† IMPORTANT (Phase 2 - Post MVP)

6. **Ajouter champs √©tiquetage** (DLC, DLUO, lot, fabricant)
7. **G√©n√©rer √©tiquettes PDF conformes**
8. **Gestion des traces d'allerg√®nes**
9. **Validation des donn√©es nutritionnelles (Ciqual ANSES)**

#### üü° SOUHAITABLE (Phase 3)

10. **Calcul automatique du Nutri-Score**
11. **Conformit√© bio/AOP/IGP**
12. **Export multilingue**

---

## 7. POINTS DE NON-CONFORMIT√â √Ä CORRIGER

### 7.1 Migration Prisma urgente

```prisma
// backend/services/recipe-service/prisma/schema.prisma

model Ingredient {
  id          String   @id @default(uuid())
  userId      String
  name        String
  unit        String   @default("g")
  pricePerUnit Float   @default(0)
  
  // VALEURS NUTRITIONNELLES (pour 100g/100ml)
  // Obligatoires INCO
  calories       Float? // kcal
  proteins       Float? // g
  carbs          Float? // g - Glucides totaux
  sugars         Float? // g - dont sucres (OBLIGATOIRE INCO) üÜï
  fats           Float? // g - Mati√®res grasses totales
  saturatedFats  Float? // g - dont acides gras satur√©s (OBLIGATOIRE INCO) üÜï
  salt           Float? // g - Sel
  
  // Facultatifs (nice to have)
  fiber          Float? // g - Fibres alimentaires
  sodium         Float? // g - Sodium (sel = sodium * 2.5)
  
  // Allerg√®nes (14 ADO)
  allergens      String?  // CSV: "gluten,lait,oeufs"
  allergenTraces String?  // Traces possibles: "fruits-a-coque,arachides" üÜï
  
  // Relations
  recipes     RecipeIngredient[]
  
  // M√©tadonn√©es
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([userId])
  @@index([name])
  @@map("ingredients")
}

model Recipe {
  id          String   @id @default(uuid())
  userId      String
  name        String
  description String?
  category    String?
  servings    Int      @default(1)
  
  // NOUVEAUX CHAMPS pour √©tiquetage üÜï
  batchNumber String?  // Num√©ro de lot (ex: "2025-10-24-001")
  dlc         DateTime? // Date Limite de Consommation
  dluo        DateTime? // Date Limite d'Utilisation Optimale
  storageInstructions String? // Conditions de conservation
  
  // Relations
  ingredients RecipeIngredient[]
  
  // M√©tadonn√©es
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([userId])
  @@index([category])
  @@map("recipes")
}
```

### 7.2 Corrections du service nutrition

```javascript
// backend/services/recipe-service/src/services/nutrition.service.js

export const calculateNutrition = async (recipeId) => {
  // ... code existant ...

  // Calculer pour 100g (bas√© sur poids FINAL)
  const per100g = totalWeightFinal > 0 ? {
    // üÜï √ânergie en kJ ET kcal (OBLIGATOIRE INCO)
    energyKj: Math.round((totalCalories / totalWeightFinal) * 100 * 4.184),
    energyKcal: Math.round((totalCalories / totalWeightFinal) * 100 * 10) / 10,
    
    proteins: Math.round((totalProteins / totalWeightFinal) * 100 * 10) / 10,
    
    carbs: Math.round((totalCarbs / totalWeightFinal) * 100 * 10) / 10,
    sugars: Math.round((totalSugars / totalWeightFinal) * 100 * 10) / 10, // üÜï
    
    fats: Math.round((totalFats / totalWeightFinal) * 100 * 10) / 10,
    saturatedFats: Math.round((totalSaturatedFats / totalWeightFinal) * 100 * 10) / 10, // üÜï
    
    // üîß Sel : 2 d√©cimales (au lieu de 1)
    salt: Math.round((totalSalt / totalWeightFinal) * 100 * 100) / 100
  } : {
    energyKj: 0,
    energyKcal: 0,
    proteins: 0,
    carbs: 0,
    sugars: 0, // üÜï
    fats: 0,
    saturatedFats: 0, // üÜï
    salt: 0
  };

  return {
    per100g,
    perServing,
    totalWeight: totalWeightFinal
  };
};
```

### 7.3 Nouveau service : G√©n√©ration liste d'ingr√©dients

```javascript
// backend/services/recipe-service/src/services/ingredient-list.service.js

/**
 * G√©n√®re la liste d'ingr√©dients conforme INCO (ordre pond√©ral d√©croissant)
 * @param {string} recipeId
 * @returns {Promise<string>} Liste format√©e avec allerg√®nes en GRAS
 */
export const generateIngredientList = async (recipeId) => {
  const recipe = await prisma.recipe.findUnique({
    where: { id: recipeId },
    include: {
      ingredients: {
        include: {
          ingredient: true
        },
        orderBy: {
          quantity: 'desc' // Tri par poids d√©croissant
        }
      }
    }
  });

  const totalWeight = recipe.ingredients.reduce((sum, ri) => sum + ri.quantity, 0);

  const ingredientList = recipe.ingredients.map(ri => {
    const percentage = ((ri.quantity / totalWeight) * 100).toFixed(1);
    const name = ri.ingredient.name;
    
    // Mise en √©vidence des allerg√®nes
    const allergens = ri.ingredient.allergens ? ri.ingredient.allergens.split(',') : [];
    const hasAllergen = allergens.length > 0;
    
    // Format HTML pour PDF (ou ** pour markdown)
    const formattedName = hasAllergen 
      ? `<strong>${name.toUpperCase()}</strong>` 
      : name;
    
    return `${formattedName} (${percentage}%)`;
  });

  return `Ingr√©dients : ${ingredientList.join(', ')}`;
};
```

---

## 8. RECOMMANDATIONS ET BEST PRACTICES

### 8.1 Checklist avant lancement MVP

- [ ] Migrer Prisma : ajouter `sugars`, `saturatedFats`, `allergenTraces`
- [ ] Corriger `nutrition.service.js` : kJ, sucres, acides gras satur√©s, sel 2 d√©cimales
- [ ] Impl√©menter `generateIngredientList()` avec tri pond√©ral
- [ ] Ajouter mise en √©vidence allerg√®nes (GRAS)
- [ ] Tester avec donn√©es r√©elles (base Ciqual ANSES)
- [ ] Valider calculs avec expert nutrition
- [ ] Tests unitaires : cas limites (perte 100%, allerg√®nes multiples)

### 8.2 Validation des donn√©es nutritionnelles

üîó **Source officielle** : Base Ciqual ANSES  
https://ciqual.anses.fr/

**Recommandation** : Importer les donn√©es depuis Ciqual pour garantir la fiabilit√© :
- 3 200+ aliments
- Valeurs valid√©es scientifiquement
- Mise √† jour annuelle

### 8.3 Disclaimer l√©gal √† ajouter

Sur l'interface utilisateur :

```
‚ö†Ô∏è IMPORTANT
Les valeurs nutritionnelles affich√©es sont calcul√©es automatiquement √† partir 
des ingr√©dients saisis. Il est de la responsabilit√© de l'utilisateur de v√©rifier 
l'exactitude des donn√©es sources. En cas de doute, consultez un expert en nutrition.

Les calculs sont conformes au R√®glement (UE) n¬∞1169/2011 (INCO).
```

### 8.4 Bonnes pratiques additionnelles

1. **Tra√ßabilit√©** : Logger tous les calculs (date, version de l'algo)
2. **Audit trail** : Conserver l'historique des modifications d'ingr√©dients
3. **Validation crois√©e** : Alerte si valeurs aberrantes (ex: 500g de sel/100g)
4. **Cache invalidation** : Recalculer si ingr√©dient modifi√©
5. **Export PDF** : G√©n√©rer √©tiquettes conformes (format A4, 40x30mm, etc.)

---

## 9. RESSOURCES ET CONTACTS

### 9.1 Textes officiels

- **R√®glement INCO** : https://eur-lex.europa.eu/legal-content/FR/TXT/?uri=CELEX:32011R1169
- **DGCCRF √âtiquetage** : https://www.economie.gouv.fr/dgccrf/etiquetage-des-denrees-alimentaires
- **Base Ciqual ANSES** : https://ciqual.anses.fr/

### 9.2 Organismes de contr√¥le

- **DGCCRF** : Direction G√©n√©rale de la Concurrence, de la Consommation et de la R√©pression des Fraudes
- **ANSES** : Agence Nationale de S√©curit√© Sanitaire de l'Alimentation
- **Chambre des M√©tiers** : Support aux artisans

### 9.3 Organismes professionnels

- **Conf√©d√©ration Nationale de la Boulangerie-P√¢tisserie**
- **Union des M√©tiers et des Industries de l'H√¥tellerie (UMIH)**
- **F√©d√©ration des Entreprises de Boulangerie et P√¢tisserie Fran√ßaises (FEBPF)**

---

## üìù R√âSUM√â EX√âCUTIF - ACTIONS IMM√âDIATES

### üî¥ CRITIQUE (Bloquer le lancement sans ces correctifs)

1. ‚úÖ Ajouter `sugars` et `saturatedFats` dans Prisma
2. ‚úÖ Ajouter calcul kJ (√©nergieKj = kcal * 4.184)
3. ‚úÖ Corriger arrondi sel (2 d√©cimales au lieu de 1)

### üü† IMPORTANT (√Ä faire avant commercialisation)

4. ‚úÖ Impl√©menter g√©n√©ration liste d'ingr√©dients tri√©e
5. ‚úÖ Mise en √©vidence allerg√®nes en GRAS
6. ‚úÖ Ajouter champs DLC/DLUO/lot dans Recipe

### üü° RECOMMAND√â (Post-MVP)

7. ‚úÖ Import base Ciqual ANSES
8. ‚úÖ G√©n√©ration √©tiquettes PDF conformes
9. ‚úÖ Tests de validation avec expert nutrition

---

**Document valid√© par** : Analyse r√©glementaire compl√®te  
**Prochaine r√©vision** : √Ä chaque mise √† jour du R√®glement INCO  
**Contact** : DGCCRF (https://signal.conso.gouv.fr)

---

*Ce document est fourni √† titre informatif. En cas de doute, consultez un avocat sp√©cialis√© en droit alimentaire.*
